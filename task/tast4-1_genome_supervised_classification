# Учебное задание 4.1: Обучение с учителем - классификация популяций по генетическим данным

## Задача

> **У вас есть датасет** генетических последовательностей в формате ATGC, содержащий бинарные признаки мутаций для индивидов из 7 популяций. Популяции закодированы в 7 классво: ACB, ASW, ESN, GWD, LWK, MSL, YRI. Каждый образец помечен меткой популяции, и **вы должны использовать эти метки при обучении** — это *задача обучения с учителем*.

> **Вы должны написать код для классификации индивидов по популяциям**, выполнив следующие шаги:
> 1. Загрузить и предобработать генетические данные из файла `dataset/task4_1-genomic-ATGC-seq.txt` (бинарное кодирование мутаций)
> 2. Построить граф сходства k-NN, где узлы — индивиды, а рёбра — генетическая близость
> 3. Реализовать и обучить графовую свёрточную сеть (GCN) для классификации популяций
> 4. Оценить качество модели на тестовой выборке с помощью метрик, рассчитав Accuracy и F1-score

**Ожидаемый результат**: рабочий код с комментариями, где реализована модель GCN, которая классифицирует индивидов по популяциям, *используя структуру графа для учета генетических взаимосвязей*.

---

## Описание датасета

| Свойство | Значение |
|----------|-------|
| **Формат** | Текстовый файл с разделителями (`.txt`) |
| **Образцы** | ~1000 индивидов |
| **Признаки** | 10 101 бинарный признак|
| **Метки** | 7 популяций: ACB, ASW, ESN, GWD, LWK, MSL, YRI |
| **Файл** | `task4_1-genomic-ATGC-seq.txt` |

Пример строки данных:
```
ID123  2  ACB  A A T C G G G A C C G G C C C T T C G...
```
Каждая строка содержит:
Идентификатор образца (например, NA19144)
Пол (1 или 2)
Популяцию (YRI, ASW и т.д.)
Последовательность нуклеотидов (A, T, G, C)

---

## Требования к коду

✅ **Код** (`.ipynb` или `.py`), содержащий:
- Функцию загрузки и предобработки данных 
- Построение графа (например, с использованием `sklearn.neighbors.kneighbors_graph`)
- Реализацию модели GCN с использованием `torch-geometric`
- Цикл обучения с валидацией и ранней остановкой
- Оценку на выборке: Accuracy, macro F1-score, матрица ошибок

✅ **Краткий отчёт** (не более 2000 знаков):
- Как Вы обрабатывали дисбаланс классов в датасете?
- Почему GCN подходит для этой задачи лучше, чем обычный MLP?
- Какие популяции модель классифицирует хуже всего и почему, на Ваш взгляд?

✅ **Визуализация в коде**:
- Граф генетического сходства (подграф первых 100 узлов), раскрашенный по истинным популяциям
- Матрица ошибок (confusion matrix) на тестовой выборке
- Результаты классификации F1-score на обучении и валидации
